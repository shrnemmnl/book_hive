{% load price_filters %}
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Tax Invoice</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            font-size: 11pt;
            margin: 20px;
            color: black;
            line-height: 1.4;
        }
        
        .invoice-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #000;
            padding-bottom: 15px;
        }
        
        .invoice-header h1 {
            font-size: 20pt;
            font-weight: bold;
            margin: 0;
            margin-bottom: 10px;
        }
        
        .invoice-header p {
            margin: 5px 0;
            font-size: 10pt;
        }
        
        .seller-customer-section {
            margin-bottom: 25px;
        }
        
        .seller-section, .customer-section {
            margin-bottom: 20px;
        }
        
        .seller-section h3, .customer-section h3 {
            font-size: 12pt;
            font-weight: bold;
            margin-bottom: 8px;
            text-decoration: underline;
        }
        
        .seller-section p, .customer-section p {
            margin: 3px 0;
            font-size: 10pt;
        }
        
        .order-details-section {
            margin-bottom: 20px;
            padding: 10px 0;
        }
        
        .order-details-section h3 {
            font-size: 12pt;
            font-weight: bold;
            margin-bottom: 8px;
            text-decoration: underline;
        }
        
        .order-details-section p {
            margin: 2px 0;
            font-size: 10pt;
            line-height: 1.4;
        }
        
        .items-section {
            margin-bottom: 20px;
        }
        
        .items-section h3 {
            font-size: 12pt;
            font-weight: bold;
            margin-bottom: 10px;
            text-decoration: underline;
        }
        
        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .items-table th {
            background-color: #f0f0f0;
            border: 1px solid #000;
            padding: 8px;
            text-align: left;
            font-weight: bold;
            font-size: 10pt;
        }
        
        .items-table td {
            border: 1px solid #000;
            padding: 8px;
            font-size: 10pt;
        }
        
        .items-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .invoice-summary {
            margin-top: 25px;
            padding-top: 15px;
        }
        
        .invoice-summary h3 {
            font-size: 12pt;
            font-weight: bold;
            margin-bottom: 10px;
            text-decoration: underline;
        }
        
        .summary-row {
            margin-bottom: 8px;
            font-size: 10pt;
            line-height: 1.8;
        }
        
        .summary-label {
            font-weight: normal;
            display: inline-block;
            min-width: 150px;
        }
        
        .summary-value {
            font-weight: normal;
            display: inline-block;
        }
        
        .total-row {
            margin-top: 10px;
            font-size: 16pt;
            font-weight: bold;
        }
        
        .total-row .summary-label {
            font-size: 16pt;
            font-weight: bold;
        }
        
        .total-row .summary-value {
            font-size: 16pt;
            font-weight: bold;
        }
        
        .notes-section {
            margin-top: 30px;
            border-top: 1px solid #000;
            padding-top: 15px;
        }
        
        .notes-section h3 {
            font-size: 12pt;
            font-weight: bold;
            margin-bottom: 8px;
            text-decoration: underline;
        }
        
        .notes-section p {
            margin: 5px 0;
            font-size: 10pt;
        }
        
        .divider {
            border-top: 1px solid #000;
            margin: 20px 0;
        }
    </style>
</head>
<body>

<div class="invoice-header">
    <h1>TAX INVOICE</h1>
    <p><strong>Invoice No:</strong> {{ invoice.invoice_number }}</p>
    <p><strong>Invoice Date:</strong> {{ invoice.invoice_date|date:"d M Y" }}</p>
</div>

<div class="seller-customer-section">
    <div class="seller-section">
        <h3>Seller:</h3>
        <p><strong>{{ invoice.seller_name }}</strong></p>
        <p>{{ invoice.seller_address }}</p>
        <p>Phone: {{ invoice.seller_phone }}</p>
        <p>Email: {{ invoice.seller_email }}</p>
        <p>GSTIN: {{ invoice.seller_gstin }}</p>
    </div>
    
    <div class="customer-section">
        <h3>Customer:</h3>
        <p><strong>{{ invoice.customer_name }}</strong></p>
        <p>{{ invoice.customer_address }}</p>
        <p>Phone: {{ invoice.customer_phone }}</p>
        <p>Email: {{ invoice.customer_email }}</p>
    </div>
</div>

<div class="order-details-section">
    <h3>Order Details:</h3>
    <p><strong>Order ID:</strong> {{ invoice.snapshot_order_id }}</p>
    <p><strong>Order Date:</strong> {{ invoice.order_date|date:"d M Y" }}</p>
    <p><strong>Payment Method:</strong> {{ invoice.payment_method }}</p>
    {% if invoice.transaction_id %}
    <p><strong>Transaction ID:</strong> {{ invoice.transaction_id }}</p>
    {% endif %}
</div>

<div class="divider"></div>

<div class="items-section">
    <h3>Items:</h3>
    <table class="items-table">
        <thead>
            <tr>
                <th>#</th>
                <th>Item Name</th>
                <th>Qty</th>
                <th>Price</th>
                <th>Line Total</th>
            </tr>
        </thead>
        <tbody>
            {% for item in order_items %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ item.name }}</td>
                <td>{{ item.quantity }}</td>
                <td>Rs. {{ item.price|floatformat:2 }}</td>
                <td>Rs. {{ item.line_total|floatformat:2 }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="invoice-summary">
    <h3>Invoice Summary:</h3>
    <div class="summary-row">
        <span class="summary-label">Subtotal:</span> <span class="summary-value">Rs. {{ invoice.subtotal|floatformat:2 }}</span>
    </div>
    <div class="summary-row">
        <span class="summary-label">Discount:</span> <span class="summary-value">Rs. {{ invoice.total_discount|floatformat:2 }}</span>
    </div>
    <div class="summary-row">
        <span class="summary-label">Shipping:</span> <span class="summary-value">Rs. {{ invoice.shipping|floatformat:2 }}</span>
    </div>
    <div class="summary-row total-row">
        <span class="summary-label">Total Amount Payable:</span> <span class="summary-value">Rs. {{ invoice.total_amount|floatformat:2 }}</span>
    </div>
</div>

<div class="divider"></div>

<div class="notes-section">
    <h3>Notes:</h3>
    <p>Thank you for shopping with Book Hive.</p>
    <p>For refunds or returns, refer to our policy.</p>
</div>

<div class="divider"></div>

</body>
</html>
